"use strict";(self.webpackChunkchatapp=self.webpackChunkchatapp||[]).push([[3455],{7513:(N,x,t)=>{t.r(x),t.d(x,{default:()=>ge});var e=t(67294),n=t(57993),f=t(86706),T=t(36364),y=t(185),b=t(53979),W=t(29728),U=t(36989),S=t(49066),E=t(38939),F=t(49386),K=t(8060),V=t(79031),v=t(37909),O=t(75515),z=t(63237),X=t(15234),G=t(65186),J=t(4585),Y=t(20022),k=t(96315),w=t(27361),q=t.n(w),Z=t(86896),_=t(16550),ee=t(14900);const te=()=>"todo empty role";var ne=t(11047),le=t(41580),se=t(12028),ae=t(45697),L=t.n(ae);const $=({id:s,name:c,description:l,usersCount:h,icons:u,rowIndex:r,canUpdate:M})=>{const{formatMessage:p}=(0,Z.Z)(),[,o]=u,C=p({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:h});return e.createElement(V.Tr,{"aria-rowindex":r,key:s,...M?(0,n.X7)({fn:o.onClick}):{}},e.createElement(v.Td,{maxWidth:(0,n.Q1)(130)},e.createElement(O.Z,{ellipsis:!0,textColor:"neutral800"},c)),e.createElement(v.Td,{maxWidth:(0,n.Q1)(250)},e.createElement(O.Z,{ellipsis:!0,textColor:"neutral800"},l)),e.createElement(v.Td,null,e.createElement(O.Z,{textColor:"neutral800"},C)),e.createElement(v.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...n.UW},u.map((i,R)=>i?e.createElement(le.x,{key:i.label,paddingLeft:R===0?0:1},e.createElement(se.h,{onClick:i.onClick,label:i.label,noBorder:!0,icon:i.icon})):null))))};$.propTypes={id:L().number.isRequired,name:L().string.isRequired,description:L().string.isRequired,usersCount:L().number.isRequired,icons:L().array.isRequired,rowIndex:L().number.isRequired,canUpdate:L().bool},$.defaultProps={canUpdate:!1};const oe=$;var re=t(18172);const ie={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},de=(s,c)=>(0,re.ZP)(s,l=>{switch(c.type){case"ON_REMOVE_ROLES":{l.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{l.shouldRefetchData=!0,l.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{l.shouldRefetchData=!1,l.roleToDelete=null,l.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{l.roleToDelete=c.id;break}default:return l}}),ce=()=>{(0,n.go)();const{locale:s}=(0,Z.Z)(),c=(0,f.v9)(T._),{isLoading:l,allowedActions:{canCreate:h,canDelete:u,canRead:r,canUpdate:M}}=(0,n.ss)(c.settings.roles),{getData:p,roles:o,isLoading:C}=(0,ee.bF)(!1),[{query:i}]=(0,n.Kx)(),R=(i==null?void 0:i._q)||"",{includes:D}=(0,n.L0)(s,{sensitivity:"base"}),P=(0,n.Xe)(s,{sensitivity:"base"}),j=(o||[]).filter(m=>D(m.name,R)||D(m.description,R)).sort((m,A)=>P.compare(m.name,A.name)||P.compare(m.description,A.description));return(0,e.useEffect)(()=>{!l&&r&&p()},[l,r,p]),{isLoadingForPermissions:l,canCreate:h,canDelete:u,canRead:r,canUpdate:M,isLoading:C,getData:p,sortedRoles:j,roles:o}},ue=({getData:s,canCreate:c,canDelete:l,canUpdate:h})=>{const{formatMessage:u}=(0,Z.Z)(),r=(0,n.lm)(),[M,p]=(0,e.useState)(!1),{push:o}=(0,_.k6)(),[{selectedRoles:C,showModalConfirmButtonLoading:i,roleToDelete:R},D]=(0,e.useReducer)(de,ie),{post:P}=(0,n.tg)(),j=async()=>{try{D({type:"ON_REMOVE_ROLES"}),await P("/admin/roles/batch-delete",{ids:[R]}),await s(),D({type:"RESET_DATA_TO_DELETE"})}catch(a){const d=q()(a,["response","payload","data","ids"],null);if(d&&Array.isArray(d)){const he=d.join(`
`);r({type:"warning",message:he})}else r({type:"warning",message:{id:"notification.error"}})}g()},m=(0,e.useCallback)(a=>{o(`/settings/roles/duplicate/${a}`)},[o]),A=()=>o("/settings/roles/new"),B=(0,e.useCallback)(a=>{D({type:"SET_ROLE_TO_DELETE",id:a}),g()},[]),g=()=>p(a=>!a),I=(0,e.useCallback)(a=>{o(`/settings/roles/${a}`)},[o]),H=(0,e.useCallback)((a,d)=>{a.preventDefault(),a.stopPropagation(),d.usersCount?r({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):B(d.id)},[r,B]),Q=(0,e.useCallback)((a,d)=>{a.preventDefault(),a.stopPropagation(),m(d.id)},[m]),Ee=(0,e.useCallback)(a=>[...c?[{onClick:d=>Q(d,a),label:u({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(G.Z,null)}]:[],...h?[{onClick:()=>I(a.id),label:u({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(J.Z,null)}]:[],...l?[{onClick:d=>H(d,a),label:u({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Y.Z,null)}]:[]],[u,H,Q,I,c,h,l]);return{handleNewRoleClick:A,getIcons:Ee,selectedRoles:C,isWarningDeleteAllOpened:M,showModalConfirmButtonLoading:i,handleToggleModal:g,handleDeleteData:j}},me=()=>{const{formatMessage:s}=(0,Z.Z)(),{isLoadingForPermissions:c,canCreate:l,canRead:h,canDelete:u,canUpdate:r,isLoading:M,getData:p,sortedRoles:o}=ce(),{handleNewRoleClick:C,getIcons:i,isWarningDeleteAllOpened:R,showModalConfirmButtonLoading:D,handleToggleModal:P,handleDeleteData:j}=ue({getData:p,canCreate:l,canDelete:u,canUpdate:r}),m=o.length+1,A=6;if(c)return e.createElement(y.o,null,e.createElement(n.dO,null));const B=s({id:"global.roles",defaultMessage:"roles"});return e.createElement(y.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(b.T,{primaryAction:l?e.createElement(W.z,{onClick:C,startIcon:e.createElement(k.Z,null),size:"S"},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:B,subtitle:s({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),h&&e.createElement(U.Z,{startActions:e.createElement(n.m,{label:s({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:B})})}),h&&e.createElement(S.D,null,e.createElement(E.i,{colCount:A,rowCount:m,footer:l?e.createElement(F.c,{onClick:C,icon:e.createElement(k.Z,null)},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(K.h,null,e.createElement(V.Tr,{"aria-rowindex":1},e.createElement(v.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.name",defaultMessage:"Name"}))),e.createElement(v.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.description",defaultMessage:"Description"}))),e.createElement(v.Th,null,e.createElement(O.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.users",defaultMessage:"Users"}))),e.createElement(v.Th,null,e.createElement(z.T,null,s({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(X.p,null,o==null?void 0:o.map((g,I)=>e.createElement(oe,{key:g.id,id:g.id,name:g.name,description:g.description,usersCount:g.usersCount,icons:i(g),rowIndex:I+2,canUpdate:r})))),!m&&!M&&e.createElement(te,null)),e.createElement(n.QH,{isOpen:R,onConfirm:j,isConfirmButtonLoading:D,onToggleDialog:P}))},ge=()=>{const s=(0,f.v9)(T._);return e.createElement(n.O4,{permissions:s.settings.roles.main},e.createElement(me,null))}},36989:(N,x,t)=>{t.d(x,{Z:()=>f});var e=t(85893),n=t(11047);const f=({startActions:T,endActions:y})=>!T&&!y?null:(0,e.jsxs)(n.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(n.k,{gap:2,wrap:"wrap",children:T}),(0,e.jsx)(n.k,{gap:2,shrink:0,wrap:"wrap",children:y})]})},49386:(N,x,t)=>{t.d(x,{c:()=>S});var e=t(85893),n=t(88972),f=t(41580),T=t(70004),y=t(11047),b=t(75515);const W=(0,n.ZP)(f.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:E})=>E.colors.primary600};
  }
`,U=(0,n.ZP)(f.x)`
  border-radius: 0 0 ${({theme:E})=>E.borderRadius} ${({theme:E})=>E.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,S=({children:E,icon:F,...K})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(T.i,{}),(0,e.jsx)(U,{as:"button",background:"primary100",padding:5,...K,children:(0,e.jsxs)(y.k,{children:[(0,e.jsx)(W,{"aria-hidden":!0,background:"primary200",children:F}),(0,e.jsx)(f.x,{paddingLeft:3,children:(0,e.jsx)(b.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:E})})]})})]})}}]);
