"use strict";(self.webpackChunkchatapp=self.webpackChunkchatapp||[]).push([[4263],{54920:(R,c,e)=>{e.d(c,{R:()=>o});var t=e(57993),a=e(88767);function o(r={},f={}){var l;const{id:n="",...m}=r,{get:g}=(0,t.kY)(),{data:s,isError:i,isLoading:v,refetch:L}=(0,a.useQuery)(["users",n,m],async()=>{const{data:{data:h}}=await g(`/admin/users/${n}`,{params:m});return h},f);let M=[];return n&&s?M=[s]:Array.isArray(s==null?void 0:s.results)&&(M=s.results),{users:M,pagination:(l=s==null?void 0:s.pagination)!=null?l:null,isLoading:v,isError:i,refetch:L}}},93552:(R,c,e)=>{e.r(c),e.d(c,{default:()=>re});var t=e(67294),a=e(57993),o=e(86706),r=e(16550),f=e(36364),l=e(185),n=e(53979),m=e(29728),g=e(49066),s=e(41580),i=e(11047),v=e(75515),L=e(11276),M=e(67819),h=e(85018),B=e(67109),W=e(41054),U=e(27361),z=e.n(U),Y=e(57557),H=e.n(Y),X=e(78718),A=e.n(X),V=e(45697),G=e.n(V),Q=e(86896),J=e(54920),b=e(80902),p=e(25804),ee=e(30164),te=e(85078),ae=e(39394);const se=async(D,u)=>{const{put:P}=(0,a.tg)(),{data:K}=await P(`/admin/users/${D}`,u);return K.data},ne=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],w=["email","firstname","lastname","username","isActive","roles"],k=({canUpdate:D})=>{const{formatMessage:u}=(0,Q.Z)(),{params:{id:P}}=(0,r.$B)("/settings/users/:id"),{push:K}=(0,r.k6)(),{setUserDisplayName:x}=(0,a.L7)(),O=(0,a.lm)(),{lockApp:Z,unlockApp:$}=(0,a.o1)(),F=(0,b.c)(ee.A,async()=>(await e.e(566).then(e.bind(e,20566))).MagicLinkEE);(0,a.go)();const{users:[I],isLoading:le}=(0,J.R)({id:P},{onError(d){const{status:E}=d.response;E===403?(O({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),K("/")):O({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),ie=async(d,E)=>{Z();try{const y=await se(P,H()(d,"confirmPassword"));O({type:"success",message:u({id:"notification.success.saved",defaultMessage:"Saved"})});const C=a.I8.getUserInfo();if(P.toString()===C.id.toString()){a.I8.setUserInfo(y);const S=z()(d,"username")||(0,p.Pp)(d.firstname,d.lastname);x(S)}E.setValues(A()(d,w))}catch(y){const C=(0,p.Iz)(y.response.data),S=Object.keys(C).reduce((N,T)=>(N[T]=C[T].id,N),{});E.setErrors(S),O({type:"warning",message:z()(y,"response.data.error.message","notification.error")})}$()},_=le||!F,de=_?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},j=Object.keys(A()(I,w)).reduce((d,E)=>E==="roles"?(d[E]=((I==null?void 0:I.roles)||[]).map(({id:y})=>y),d):(d[E]=I==null?void 0:I[E],d),{}),ce=j.username||(0,p.Pp)(j.firstname,j.lastname),q=u(de,{name:ce});return _?t.createElement(l.o,{"aria-busy":"true"},t.createElement(a.SL,{name:"Users"}),t.createElement(n.T,{primaryAction:t.createElement(m.z,{disabled:!0,startIcon:t.createElement(h.Z,null),type:"button",size:"L"},u({id:"global.save",defaultMessage:"Save"})),title:q,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(B.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},u({id:"global.back",defaultMessage:"Back"}))}),t.createElement(g.D,null,t.createElement(a.dO,null))):t.createElement(l.o,null,t.createElement(a.SL,{name:"Users"}),t.createElement(W.J9,{onSubmit:ie,initialValues:j,validateOnChange:!1,validationSchema:ae.YM},({errors:d,values:E,handleChange:y,isSubmitting:C,dirty:S})=>t.createElement(a.l0,null,t.createElement(n.T,{primaryAction:t.createElement(m.z,{disabled:C||!D?!0:!S,startIcon:t.createElement(h.Z,null),loading:C,type:"submit",size:"L"},u({id:"global.save",defaultMessage:"Save"})),title:q,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(B.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},u({id:"global.back",defaultMessage:"Back"}))}),t.createElement(g.D,null,(I==null?void 0:I.registrationToken)&&t.createElement(s.x,{paddingBottom:6},t.createElement(F,{registrationToken:I.registrationToken})),t.createElement(i.k,{direction:"column",alignItems:"stretch",gap:7},t.createElement(s.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(i.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(v.Z,{variant:"delta",as:"h2"},u({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(L.r,{gap:5},ne.map(N=>N.map(T=>t.createElement(M.P,{key:T.name,...T.size},t.createElement(a.jm,{...T,disabled:!D,error:d[T.name],onChange:y,value:E[T.name]||""}))))))),t.createElement(s.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(i.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(v.Z,{variant:"delta",as:"h2"},u({id:"global.roles",defaultMessage:"User's role"})),t.createElement(L.r,{gap:5},t.createElement(M.P,{col:6,xs:12},t.createElement(te.Z,{disabled:!D,error:d.roles,onChange:y,value:E.roles}))))))))))};k.propTypes={canUpdate:G().bool.isRequired};const oe=k,re=()=>{var D;const u=(0,a.lm)(),P=(0,o.v9)(f._),K=t.useMemo(()=>({read:P.settings.users.read,update:P.settings.users.update}),[P.settings.users]),{isLoading:x,allowedActions:{canRead:O,canUpdate:Z}}=(0,a.ss)(K),{state:$}=(0,r.TH)(),F=(D=$==null?void 0:$.from)!=null?D:"/";return(0,t.useEffect)(()=>{x||!O&&!Z&&u({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[x,O,Z,u]),x?t.createElement(a.dO,null):!O&&!Z?t.createElement(r.l_,{to:F}):t.createElement(oe,{canUpdate:Z})}},6324:(R,c,e)=>{e.d(c,{Z:()=>g});var t=e(67294),a=e(12028),o=e(57993),r=e(65186),f=e(45697),l=e.n(f),n=e(86896);const m=({children:s,target:i})=>{const v=(0,o.lm)(),{formatMessage:L}=(0,n.Z)(),{copy:M}=(0,o.VP)(),h=L({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),B=async()=>{await M(i)&&v({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(o.Y_,{endAction:t.createElement(a.h,{label:h,noBorder:!0,icon:t.createElement(r.Z,null),onClick:B}),title:i,titleEllipsis:!0,subtitle:s,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};m.propTypes={children:l().oneOfType([l().element,l().string]).isRequired,target:l().string.isRequired};const g=m},30164:(R,c,e)=>{e.d(c,{A:()=>n});var t=e(67294),a=e(45697),o=e.n(a),r=e(86896),f=e(95651),l=e(6324);const n=({registrationToken:m})=>{const{formatMessage:g}=(0,r.Z)(),s=`${window.location.origin}${f.Z}auth/register?registrationToken=${m}`;return t.createElement(l.Z,{target:s},g({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};n.defaultProps={registrationToken:""},n.propTypes={registrationToken:o().string}},85078:(R,c,e)=>{e.d(c,{Z:()=>B});var t=e(67294),a=e(40619),o=e(82562),r=e(57993),f=e(86647),l=e(45697),n=e.n(l),m=e(86896),g=e(88767),s=e(88972);const i=(0,s.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,v=s.ZP.div`
  animation: ${i} 2s infinite linear;
`,L=()=>t.createElement(v,null,t.createElement(f.Z,null)),M=async()=>{const{get:W}=(0,r.tg)(),{data:U}=await W("/admin/roles");return U.data},h=({disabled:W,error:U,onChange:z,value:Y})=>{const{status:H,data:X}=(0,g.useQuery)(["roles"],M,{staleTime:5e4}),{formatMessage:A}=(0,m.Z)(),V=U?A({id:U,defaultMessage:U}):"",G=A({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),Q=A({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),J=A({id:"app.components.Select.placeholder",defaultMessage:"Select"}),b=H==="loading"?t.createElement(L,null):void 0;return t.createElement(a.P,{id:"roles",disabled:W,error:V,hint:Q,label:G,name:"roles",onChange:p=>{z({target:{name:"roles",value:p}})},placeholder:J,multi:!0,startIcon:b,value:Y.map(p=>p.toString()),withTags:!0,required:!0},(X||[]).map(p=>t.createElement(o.W,{key:p.id,value:p.id.toString()},A({id:`global.${p.code}`,defaultMessage:p.name}))))};h.defaultProps={disabled:!1,error:void 0},h.propTypes={disabled:n().bool,error:n().string,onChange:n().func.isRequired,value:n().array.isRequired};const B=h},39394:(R,c,e)=>{e.d(c,{YM:()=>g,Rw:()=>f});var t=e(87561),a=e(57993);const o={firstname:t.Z_().trim().required(a.I0.required),lastname:t.Z_(),email:t.Z_().email(a.I0.email).lowercase().required(a.I0.required),username:t.Z_().nullable(),password:t.Z_().min(8,a.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,a.I0.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(s,i)=>s?i.required(a.I0.required):i)},f={...o,currentPassword:t.Z_().when(["password","confirmPassword"],(s,i,v)=>s||i?v.required(a.I0.required):v),preferedLanguage:t.Z_().nullable()},n={roles:t.IX().min(1,a.I0.required).required(a.I0.required)},g=t.Ry().shape({...o,isActive:t.Xg(),...n})},67109:(R,c,e)=>{e.d(c,{Z:()=>o});var t=e(85893);const a=r=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...r,children:(0,t.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),o=a}}]);
