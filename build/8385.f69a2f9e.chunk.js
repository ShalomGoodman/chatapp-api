"use strict";(self.webpackChunkchatapp=self.webpackChunkchatapp||[]).push([[8385],{52713:(W,E,r)=>{r.d(E,{r:()=>C});var m=r(67294),y=r(41580),L=r(45697),b=r.n(L),S=r(99168);function F(A,M,g){if(!A||!M)return{display:"none"};const{x:I,y:x}=g;return{transform:`translate(${I}px, ${x}px)`}}function C({renderItem:A}){const{itemType:M,isDragging:g,item:I,initialOffset:x,currentOffset:j,mouseOffset:Z}=(0,S.useDragLayer)(D=>({item:D.getItem(),itemType:D.getItemType(),initialOffset:D.getInitialSourceClientOffset(),currentOffset:D.getSourceClientOffset(),isDragging:D.isDragging(),mouseOffset:D.getClientOffset()}));return g?m.createElement(y.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},m.createElement(y.x,{style:F(x,j,Z)},A({type:M,item:I}))):null}C.propTypes={renderItem:b().func.isRequired}},27661:(W,E,r)=>{var m=r(67294);const y=(0,m.createContext)();var L=null},21440:(W,E,r)=>{r.d(E,{PL:()=>S,Y9:()=>F.Y,zE:()=>re,Ky:()=>le,fi:()=>V,zH:()=>de,r5:()=>fe});var m=r(67294),y=r(86706),L=r(25398);const S=()=>{const e=(0,y.v9)(L.Z),n=(0,m.useCallback)(s=>{var t,a;return(a=(t=e==null?void 0:e.components)==null?void 0:t[s])!=null?a:{}},[e]);return{...e,getComponentLayout:n}};var F=r(79116),C=r(57993),A=r(52861),M=r(42225),g=r(18172);const I={error:null,isLoading:!0,layout:{},layouts:{}},j=(e,n)=>(0,g.ZP)(e,s=>{switch(n.type){case"GET_DATA":{s.isLoading=!0,s.error=null,s.layout={};break}case"GET_DATA_SUCCEEDED":{const t=n.data.contentType.uid;s.layout=n.data,s.layouts[t]=n.data,s.isLoading=!1;break}case"GET_DATA_ERROR":{s.isLoading=!1,s.error=n.error;break}case"SET_LAYOUT_FROM_STATE":{s.error=null,s.layout=e.layouts[n.uid];break}case"UPDATE_LAYOUT":{const t=e.layout;s.layout={...t,contentType:{uid:t.contentType.uid,...n.newLayout.contentType}},s.layouts[t.contentType.uid]={...t,contentType:{uid:t.contentType.uid,...n.newLayout.contentType}};break}default:return s}});var Z=r(50361),D=r.n(Z),w=r(27361),R=r.n(w),H=r(36968),N=r.n(H),se=r(44949);const X=(e,n)=>n.find(s=>s.uid===e),J=(e,n)=>{const s=G(e,n),t=P(s.contentType,n),a=Y(s.contentType,s.components);return N()(s,["contentType","layouts","edit"],t),N()(s,["contentType","layouts","list"],a),Object.keys(s.components).forEach(u=>{const l=P(s.components[u],n);N()(s,["components",u,"layouts","edit"],l)}),s},G=(e,n)=>{const s=(0,se.w8)(D()(e),n,"contentType"),{components:t,contentType:a}=s,u=l=>Object.keys(l.metadatas).reduce((d,h)=>{const T=R()(l,["attributes",h],{});let v=l.metadatas[h];if(T.type==="relation"){const O=X(T.targetModel,n),k=v.edit.mainField,Q={name:k,schema:R()(O,["attributes",k])};v={list:{...v.list,mainField:Q},edit:{...v.edit,mainField:Q}}}return d[h]=v,d},{});return N()(s,["contentType","metadatas"],u(a)),Object.keys(t).forEach(l=>{const d=t[l],h=u(d);N()(s,["components",l,"metadatas"],h)}),s},P=(e,n)=>e.layouts.edit.reduce((s,t)=>{const a=t.map(u=>{const l=R()(e,["attributes",u.name],{}),d={...u,fieldSchema:l,metadatas:R()(e,["metadatas",u.name,"edit"],{})};if(l.type==="relation"){const T=X(l.targetModel,n).pluginOptions||{};N()(d,"targetModelPluginOptions",T),N()(d,"queryInfos",{shouldDisplayRelationLink:K(e,u.name,n)})}return d});return s.push(a),s},[]),Y=(e,n)=>e.layouts.list.reduce((t,a)=>{const u=R()(e,["attributes",a],{}),l=R()(e,["metadatas",a,"list"],{}),d=u.type;if(d==="relation")return t.push({key:`__${a}_key__`,name:a,fieldSchema:u,metadatas:l}),t;if(d==="component"){const h=n[u.component],T=h.settings.mainField,v=h.attributes[T];return t.push({key:`__${a}_key__`,name:a,fieldSchema:u,metadatas:{...l,mainField:{...v,name:T}}}),t}return t.push({key:`__${a}_key__`,name:a,fieldSchema:u,metadatas:l}),t},[]),K=(e,n,s)=>{const t=R()(e,["attributes",n,"targetModel"],"");return U(s).includes(t)},U=e=>e.filter(n=>n.isDisplayed).map(({uid:n})=>n),z=J,re=e=>{const[{error:n,isLoading:s,layout:t,layouts:a},u]=(0,m.useReducer)(j,I),l=(0,m.useMemo)(M.Vo,[]),{schemas:d}=(0,y.v9)(k=>l(k),y.wU),h=(0,m.useRef)(!0),{get:T}=(0,C.kY)(),v=(0,m.useCallback)(async(k,Q)=>{if(a[k]){u({type:"SET_LAYOUT_FROM_STATE",uid:k});return}u({type:"GET_DATA"});try{const{data:{data:ne}}=await T(`/content-manager/content-types/${k}/configuration`,{cancelToken:Q.token});u({type:"GET_DATA_SUCCEEDED",data:z(ne,d)})}catch(ne){if(A.default.isCancel(ne))return;h.current&&console.error(ne),h.current&&u({type:"GET_DATA_ERROR",error:ne})}},[a,d,T]);(0,m.useEffect)(()=>()=>{h.current=!1},[]),(0,m.useEffect)(()=>{const Q=A.default.CancelToken.source();return v(e,Q),()=>{Q.cancel("Operation canceled by the user.")}},[e,v]);const O=(0,m.useCallback)(k=>{u({type:"UPDATE_LAYOUT",newLayout:z(k,d)})},[d]);return{error:n,isLoading:s,layout:t,updateLayout:O}},oe=e=>e["content-manager_app"].collectionTypeLinks;var ae=r(13218),ie=r.n(ae),$=r(80129);const ue=(e,n)=>Object.keys(e).reduce((s,t)=>{const a=e[t],u=R()(n,[t],a);return ie()(a)?{...s,[t]:ue(a,u)}:(s[t]=u,s)},{}),f=(e,n,s)=>{const t=e.find(({to:v})=>v.includes(n));if(!t)return"/";const{to:a,search:u}=t,l=(0,$.parse)(u),d=(0,$.parse)(s.substring(1)),h=ue(l,d);return`${a}?${(0,$.stringify)(h,{encode:!1})}`},le=e=>{const[{rawQuery:n}]=(0,C.Kx)(),s=(0,y.v9)(oe);return f(s,e,n)};var ge=r(25950),ce=r(16550);const V=()=>{const{search:e}=(0,ce.TH)(),n=e?(0,$.parse)(e.substring(1)):{};return n.plugins?(0,$.stringify)({plugins:n.plugins},{encode:!1}):""},de=e=>{const n=(0,m.useRef)();return(0,m.useEffect)(()=>{n.current=e},[e]),n.current};var B=r(14996);const p=(e,n,s)=>({type:B.m,permissions:e,__meta__:{plugins:n,containerName:s}}),ee=()=>({type:B.Q}),me=e=>e["content-manager_rbacManager"].permissions,te=e=>e.rbacProvider.collectionTypesRelatedPermissions,fe=(e,n,s="listView")=>{const t=(0,y.v9)(te),a=(0,y.v9)(me),u=(0,y.I0)(),l=t[n];return(0,m.useEffect)(()=>l?(u(p(l,e?e.plugins:null,s)),()=>{u(ee())}):()=>{},[l,u,e,s]),a};var o=r(27661);const c=()=>useContext(WysiwygContext),i=null},79116:(W,E,r)=>{r.d(E,{Y:()=>S});var m=r(67294),y=r(99168),L=r.n(y),b=r(25950);const S=(F,{type:C="STRAPI_DND",index:A,item:M={},onStart:g,onEnd:I,onGrabItem:x,onDropItem:j,onCancel:Z,onMoveItem:D,dropSensitivity:w="regular"})=>{const R=(0,m.useRef)(null),[{handlerId:H},N]=(0,y.useDrop)({accept:C,collect(P){return{handlerId:P.getHandlerId()}},hover(P,Y){if(!R.current)return;const K=P.index,U=A;if(K!==U){if(w==="regular"){const z=R.current.getBoundingClientRect(),q=(z.bottom-z.top)/2,_=Y.getClientOffset().y-z.top;if(K<U&&_<q||K>U&&_>q)return}D(U,K),P.index=U}}}),[{isDragging:se},X,J]=(0,y.useDrag)({type:C,item(){var P,Y;g&&g();const{width:K}=(Y=(P=R.current)==null?void 0:P.getBoundingClientRect())!=null?Y:{};return{index:A,width:K,...M}},end(){I&&I()},canDrag:F,isDragging:M.id?P=>M.id===P.getItem().id:void 0,collect:P=>({isDragging:P.isDragging()})}),G=(0,b.A)(F,A,{onGrabItem:x,onDropItem:j,onCancel:Z,onMoveItem:D});return[{handlerId:H,isDragging:se,handleKeyDown:G},R,N,X,J]}},25950:(W,E,r)=>{r.d(E,{A:()=>y});var m=r(67294);const y=(L,b,{onCancel:S,onDropItem:F,onGrabItem:C,onMoveItem:A})=>{const[M,g]=(0,m.useState)(!1),I=D=>{M&&(D==="UP"?A(b-1,b):D==="DOWN"&&A(b+1,b))},x=()=>{M?(F&&F(b),g(!1)):(C&&C(b),g(!0))},j=()=>{M&&(g(!1),S&&S(b))};return D=>{if(L&&!(D.key==="Tab"&&!M))switch(D.preventDefault(),D.key){case" ":case"Enter":x();break;case"Escape":j();break;case"ArrowDown":case"ArrowRight":I("DOWN");break;case"ArrowUp":case"ArrowLeft":I("UP");break;default:}}}},42225:(W,E,r)=>{r.d(E,{Jg:()=>A,KQ:()=>F,Vo:()=>C,Yg:()=>L});var m=r(20573),y=r(23301);const L=()=>g=>g["content-manager_app"]||y.E,b=()=>createSelector(L(),g=>g),S=()=>createSelector(L(),g=>g.models),F=()=>(0,m.P1)(L(),g=>({collectionTypeLinks:g.collectionTypeLinks,singleTypeLinks:g.singleTypeLinks})),C=()=>(0,m.P1)(L(),({components:g,models:I})=>({schemas:[...g,...I]})),A=(0,m.P1)(L(),g=>g.fieldSizes);var M=null},25398:(W,E,r)=>{r.d(E,{Z:()=>y});const y=L=>L["content-manager_editViewLayoutManager"].currentLayout},56837:(W,E,r)=>{r.d(E,{Z:()=>m});const m={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},45283:(W,E,r)=>{r.d(E,{Z:()=>y});const y=L=>`content-manager.${L}`},44949:(W,E,r)=>{r.d(E,{_Q:()=>_.Z,W3:()=>b,ko:()=>A,FE:()=>g,Di:()=>Z,Ex:()=>fe,du:()=>H,TA:()=>X,Ts:()=>Y,Uo:()=>U,IF:()=>q,OB:()=>re.Z,w8:()=>ye,kc:()=>le});var m=r(50361),y=r.n(m);const b=(o,c,i)=>{if(Array.isArray(o)&&c>=0&&i>=0&&c<=o.length-1&&i<=o.length-1){const e=y()(o),n=e.splice(c,1);return e.splice(i,0,n[0]),e}return o};var S=r(7334),F=r.n(S);const A=o=>{const c=o.type;return c==="relation"?!F()(o.relationType).includes("morph"):!["json","dynamiczone","richtext","password"].includes(c)&&!!c},M=(o,c)=>{typeof o=="function"?o(c):o!=null&&(o.current=c)},g=(...o)=>c=>o.forEach(i=>M(i,c));var I=r(27361),x=r.n(I);const j=(o,c)=>Object.keys(o).reduce((i,e)=>{var n,s;const t=x()(o,[e],{}),{default:a,component:u,type:l,required:d,min:h,repeatable:T}=t;if(a!==void 0&&(i[e]=a),l==="component"){const v=(s=(n=c==null?void 0:c[u])==null?void 0:n.attributes)!=null?s:{},O=j(v,c);if(d===!0&&(i[e]=T===!0?[]:O),h&&T===!0&&d){i[e]=[];for(let k=0;k<h;k+=1)i[e].push(O)}}return l==="dynamiczone"&&d===!0&&(i[e]=[]),i},{}),Z=j;var D=r(57557),w=r.n(D);const H=({layouts:o,metadatas:c,...i})=>{const e=o.list.map(t=>t.name?t.name:t),n=Object.keys(c).reduce((t,a)=>{const u=x()(c,[a],{});let l=u.edit;return l.mainField&&(l={...l,mainField:u.edit.mainField.name}),{...t,[a]:{edit:l,list:w()(u.list,["mainField"])}}},{}),s=o.edit.map(t=>t.map(({name:a,size:u})=>({name:a,size:u})));return{...i,layouts:{edit:s,list:e},metadatas:n}},N=(o,c)=>o.map(i=>({...i,subject:c})),X=o=>{const c={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(c).reduce((i,e)=>(i[e]=N(c[e],o),i),{})};var J=r(7654),G=r.n(J);const Y=o=>o.split(".").filter(c=>G()(parseInt(c,10))),U=o=>{if(o.length===0)return-1;const c=Math.max.apply(Math,o.map(i=>{var e;return(e=i.__temp_key__)!=null?e:0}));return Number.isNaN(c)?-1:c},q=o=>`/content-manager/${o}`;var re=r(45283),_=r(56837),oe=r(82492),ae=r.n(oe),ie=r(36968),$=r.n(ie);const ye=(o,c,i)=>{const e=a=>c.find(u=>u.uid===a),n=Object.assign({},o),s=o[i].uid,t=e(s);return $()(n,[i],ae()({},t,o[i])),Object.keys(o.components).forEach(a=>{const u=e(a);$()(n,["components",a],{...o.components[a],...u})}),n};var f=r(57993);const le=(o,c,i)=>{const e=(n,s)=>Object.keys(n).reduce((t,a)=>{const u=(0,f.UN)(s,a),l=x()(n,a),d=(0,f.k2)(s,[a,"component"]),h=(0,f.k2)(s,[a,"repeatable"]);return u==="dynamiczone"?(t[a]=l.map(T=>e(T,i[T.__component])),t):u==="component"?(h?t[a]=l&&l.map(T=>e(T,i[d])):t[a]=l&&e(l,i[d]),t):(u!=="password"&&(t[a]=l),t)},{});return e(o,c)};var ge=r(51584),ce=r.n(ge),pe=r(41609),V=r.n(pe),de=r(14841),B=r.n(de),p=r(87561),ee=r(72262);p.kM(p.nK,"defined",function(){return this.test("defined",f.I0.required,o=>o!==void 0)}),p.kM(p.IX,"notEmptyMin",function(o){return this.test("notEmptyMin",f.I0.min,c=>V()(c)?!0:c.length>=o)}),p.kM(p.Z_,"isInferior",function(o,c){return this.test("isInferior",o,function(i){return!i||Number.isNaN(B()(i))?!0:B()(c)>=B()(i)})}),p.kM(p.Z_,"isSuperior",function(o,c){return this.test("isSuperior",o,function(i){return!i||Number.isNaN(B()(i))?!0:B()(i)>=B()(c)})});const me=o=>x()(o,["attributes"],{}),te=(o,{components:c},i={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const e=me(o);return p.Ry().shape(Object.keys(e).reduce((n,s)=>{const t=e[s];if(t.type!=="relation"&&t.type!=="component"&&t.type!=="dynamiczone"){const a=he(t.type,t,i);n[s]=a}if(t.type==="relation"&&(n[s]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(t.relationType)?p.Ry().nullable():p.IX().nullable()),t.type==="component"){const a=te(c[t.component],{components:c},{...i,isFromComponent:!0});if(t.repeatable===!0){const{min:l,max:d,required:h}=t;let T=p.Vo(v=>{let O=p.IX().of(a);return l?h?O=O.min(l,f.I0.min):h!==!0&&V()(v)?O=O.nullable():O=O.min(l,f.I0.min):h&&!i.isDraft&&(O=O.min(1,f.I0.required)),d&&(O=O.max(d,f.I0.max)),O});return n[s]=T,n}const u=p.Vo(l=>l!==void 0?t.required===!0&&!i.isDraft?a.defined():a.nullable():t.required===!0?p.Ry().defined():p.Ry().nullable());return n[s]=u,n}if(t.type==="dynamiczone"){let a=p.IX().of(p.Vo(({__component:d})=>te(c[d],{components:c},{...i,isFromComponent:!0})));const{max:u,min:l}=t;l?t.required?a=a.test("min",f.I0.min,d=>i.isCreatingEntry?d&&d.length>=l:d===void 0?!0:d!==null&&d.length>=l).test("required",f.I0.required,d=>i.isCreatingEntry?d!==null||d!==void 0:d===void 0?!0:d!==null):a=a.notEmptyMin(l):t.required&&!i.isDraft&&(a=a.test("required",f.I0.required,d=>i.isCreatingEntry?d!==null||d!==void 0:d===void 0?!0:d!==null)),u&&(a=a.max(u,f.I0.max)),n[s]=a}return n},{}))},he=(o,c,i)=>{let e=p.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(o)&&(e=p.Z_()),o==="json"&&(e=p.nK(f.I0.json).test("isJSON",f.I0.json,n=>{if(!n||!n.length)return!0;try{return JSON.parse(n),!0}catch{return!1}}).nullable().test("required",f.I0.required,n=>!(c.required&&(!n||!n.length)))),o==="email"&&(e=e.email(f.I0.email)),["number","integer","float","decimal"].includes(o)&&(e=p.Rx().transform(n=>G()(n)?void 0:n).typeError()),o==="biginteger"&&(e=p.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(o)&&(e=p.hT()),Object.keys(c).forEach(n=>{const s=c[n];if(s||!ce()(s)&&Number.isInteger(Math.floor(s))||s===0)switch(n){case"required":{i.isDraft||(o==="password"&&i.isCreatingEntry&&(e=e.required(f.I0.required)),o!=="password"&&(i.isCreatingEntry?e=e.required(f.I0.required):e=e.test("required",f.I0.required,t=>t===void 0&&!i.isFromComponent?!0:(0,ee.Z)(o)?t===0?!0:!!t:o==="boolean"?t!=null:o==="date"||o==="datetime"?typeof t=="string"?!V()(t):!V()(t==null?void 0:t.toString()):!V()(t))));break}case"max":{o==="biginteger"?e=e.isInferior(f.I0.max,s):e=e.max(s,f.I0.max);break}case"maxLength":e=e.max(s,f.I0.maxLength);break;case"min":{o==="biginteger"?e=e.isSuperior(f.I0.min,s):e=e.min(s,f.I0.min);break}case"minLength":{i.isDraft||(e=e.min(s,f.I0.minLength));break}case"regex":e=e.matches(new RegExp(s),{message:f.I0.regex,excludeEmptyString:!c.required});break;case"lowercase":["text","textarea","email","string"].includes(o)&&(e=e.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(o)&&(e=e.strict().uppercase());break;case"positive":(0,ee.Z)(o)&&(e=e.positive());break;case"negative":(0,ee.Z)(o)&&(e=e.negative());break;default:e=e.nullable()}}),e},fe=te},72262:(W,E,r)=>{r.d(E,{Z:()=>m});function m(y){return["integer","biginteger","decimal","float","number"].includes(y)}}}]);
